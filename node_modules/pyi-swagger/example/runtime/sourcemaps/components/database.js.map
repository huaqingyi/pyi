{"version":3,"sources":["components/database.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,6BAAyD;AACzD,+DAA8E;AAC9E,wEAA2E;AAE3E,iCAAiC;AACjC,wBAAwB;AACxB,qBAAqB;AACrB,kBAAkB;AAClB,2GAA2G;AAC3G,aAAa;AACb,8GAA8G;AAC9G,SAAS;AACT,cAAc;AACd,mBAAmB;AACnB,0BAA0B;AAC1B,QAAQ;AACR,KAAK;AAEL,IAAa,QAAQ,GAArB,MAAa,QAAS,SAAQ,kBAAmC;IAO7D,YAAY,KAAuB;QAC/B,KAAK,CAAC,KAAK,CAAC,CAAC;QACb,IAAI,CAAC,EAAE,GAAG,IAAI,gCAAS,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC;IAEM,QAAQ;QACX,OAAO,IAAI,CAAC,EAAE,CAAC;IACnB,CAAC;IAEM,KAAK,CAAC,KAAgB;QACzB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QAC3B,OAAO,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;CACJ,CAAA;AAjBG;IADC,eAAS;8BACK,uCAAqB;uCAAC;AAH5B,QAAQ;IADpB,eAAS;;GACG,QAAQ,CAoBpB;AApBY,4BAAQ","file":"../../components/database.js","sourcesContent":["import { Component, PYIComponent, autowired } from 'pyi';\nimport { Sequelize, SequelizeOptions, ModelCtor } from 'sequelize-typescript';\nimport { DataBaseConfiguration } from '../config/database/database.config';\n\n// @Component<SequelizeOptions>({\n//     dialect: 'mysql',\n//     replication: {\n//         read: [\n//             { host: '127.0.0.1', username: 'root', password: 'yihq1105', port: 3306, database: 'test' },\n//         ],\n//         write: { host: '127.0.0.1', username: 'root', password: 'yihq1105', port: 3306, database: 'test' },\n//     },\n//     pool: {\n//         max: 20,\n//         idle: 60 * 1000\n//     }\n// })\n@Component\nexport class DataBase extends PYIComponent<DataBaseConfiguration> {\n\n    @autowired\n    public props!: DataBaseConfiguration;\n\n    public db: Sequelize;\n\n    constructor(props: SequelizeOptions) {\n        super(props);\n        this.db = new Sequelize(props);\n    }\n\n    public instance() {\n        return this.db;\n    }\n\n    public table(model: ModelCtor): ModelCtor {\n        this.db.addModels([model]);\n        return this.db.model(model);\n    }\n}\n"]}