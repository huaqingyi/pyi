{"version":3,"sources":["helper/before.middleware.ts"],"names":[],"mappings":";;;;;;;;AAAA,6DAA6E;AAE7E,mCAA6B;AAI7B,IAAa,gBAAgB,GAA7B,MAAa,gBAAgB;IAMlB,KAAK,CAAC,GAAG,CAAC,GAAY,EAAE,IAA2B;QACtD,IAAI,CAAC,QAAQ,CAAC,YAAY,GAAG,KAAK,CAAC;QACnC,YAAG,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE;YACrB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAChB,IAAI,CAAC,SAAS,CAAC,GAAG,GAAG,GAAG,CAAC;aAC5B;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;SACnE;QAED,OAAO,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC;IAC3B,CAAC;CACJ,CAAA;AApBY,gBAAgB;IAD5B,gCAAU,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;GAClB,gBAAgB,CAoB5B;AApBY,4CAAgB","file":"../../helper/before.middleware.js","sourcesContent":["import { Middleware, ExpressMiddlewareInterface } from 'routing-controllers';\nimport { Context } from 'koa';\nimport { map } from 'lodash';\nimport { PYIChokidar } from '../lib';\n\n@Middleware({ type: 'before' })\nexport class BeforeMiddleware implements ExpressMiddlewareInterface {\n\n    public comps!: any;\n    public error?: { use?: Error, detail: Error };\n    public chokider!: PYIChokidar;\n\n    public async use(ctx: Context, next: (ctx: Context) => any) {\n        this.chokider.isViewObject = false;\n        map(this.comps, (comp) => {\n            if (comp.prototype) {\n                comp.prototype.ctx = ctx;\n            }\n        });\n        \n        if (this.error) {\n            ctx.app.emit('error', this.error.use || this.error.detail, ctx);\n        }\n\n        return await next(ctx);\n    }\n}\n"]}