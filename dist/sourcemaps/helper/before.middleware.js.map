{"version":3,"sources":["helper/before.middleware.ts"],"names":[],"mappings":";;;;;;;;AAAA,6DAA6E;AAE7E,mCAA6B;AAI7B,IAAa,gBAAgB,GAA7B,MAAa,gBAAgB;IAMlB,KAAK,CAAC,GAAG,CAAC,GAAY,EAAE,IAA2B;QACtD,IAAI,CAAC,QAAQ,CAAC,YAAY,GAAG,KAAK,CAAC;QACnC,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;SACnE;aAAM;YACH,YAAG,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE;gBACrB,IAAI,IAAI,CAAC,SAAS,EAAE;oBAChB,IAAI,CAAC,SAAS,CAAC,GAAG,GAAG,GAAG,CAAC;iBAC5B;YACL,CAAC,CAAC,CAAC;SACN;QACD,OAAO,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC;IAC3B,CAAC;CACJ,CAAA;AAnBY,gBAAgB;IAD5B,gCAAU,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;GAClB,gBAAgB,CAmB5B;AAnBY,4CAAgB","file":"../../helper/before.middleware.js","sourcesContent":["import { Middleware, ExpressMiddlewareInterface } from 'routing-controllers';\nimport { Context } from 'koa';\nimport { map } from 'lodash';\nimport { PYIChokidar } from '../lib';\n\n@Middleware({ type: 'before' })\nexport class BeforeMiddleware implements ExpressMiddlewareInterface {\n\n    public comps!: any;\n    public error?: { use?: Error, detail: Error };\n    public chokider!: PYIChokidar;\n\n    public async use(ctx: Context, next: (ctx: Context) => any) {\n        this.chokider.isViewObject = false;\n        if (this.error) {\n            ctx.app.emit('error', this.error.use || this.error.detail, ctx);\n        } else {\n            map(this.comps, (comp) => {\n                if (comp.prototype) {\n                    comp.prototype.ctx = ctx;\n                }\n            });\n        }\n        return await next(ctx);\n    }\n}\n"]}