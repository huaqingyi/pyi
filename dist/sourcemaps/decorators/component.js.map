{"version":3,"sources":["decorators/component.ts"],"names":[],"mappings":";;;AAAA,oEAAoF;AACpF,mCAAoC;AACpC,kCAAgD;AAChD,mDAAwE;AAExE,MAAa,YAA0B,SAAQ,cAAO;IAQlD,YAAY,KAAa;QACrB,KAAK,EAAE,CAAC;IACZ,CAAC;IARM,MAAM,CAAC,KAAK;QACf,OAAO,YAAY,CAAC;IACxB,CAAC;IAQM,KAAK;QACR,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,MAAM;QACT,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AAnBD,oCAmBC;AAMD,SAAgB,SAAS,CAAC,KAAU;IAChC,MAAM,IAAI,GAAG,KAAK,IAAI,KAAK,CAAC,KAAK,IAAI,mBAAU,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;IAC9E,IAAI,IAAI,KAAK,YAAY,EAAE;QACvB,OAAO,KAAK,CAAC;KAChB;IAED,OAAO,CAAC,MAAkC,EAAE,EAAE;QAC1C,OAAO,MAAM,CAAC;IAClB,CAAC,CAAC;AACN,CAAC;AATD,8BASC;AAiBD,SAAgB,SAAS,CAAC,KAAU,EAAE,MAAe;IACjD,IAAI,MAAM,EAAE;QACR,MAAM,CAAC,GAAG,OAAO,CAAC,WAAW,CAAC,aAAa,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;QAC5D,KAAK,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACjC,OAAO,KAAK,CAAC,MAAM,CAAC,CAAC;KACxB;IACD,OAAO,CAAC,MAAW,EAAE,OAAe,EAAE,EAAE;QACpC,MAAM,CAAC,GAAG,OAAO,CAAC,WAAW,CAAC,aAAa,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;QAC9D,MAAM,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC,EAAE,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC5D,OAAO,MAAM,CAAC,OAAO,CAAC,CAAC;IAC3B,CAAC,CAAC;AACN,CAAC;AAXD,8BAWC;AAED,SAAgB,KAAK,CACjB,MAAc,EACd,SAAkB,EAClB,IAAyB,EACzB,KAA8B;IAE9B,IACI,SAAS,CAAC,KAAK,EAAE,KAAK,gCAAgB;QACtC,SAAS,CAAC,KAAK,EAAE,KAAK,mCAAmB,EAC3C;QACE,OAAO,IAAI,oCAAgB,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,sCAAkB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;KACvG;IACD,OAAO,IAAI,oCAAgB,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,sCAAkB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;AACtG,CAAC;AAbD,sBAaC","file":"../../decorators/component.js","sourcesContent":["import { FactoryComponent, ComponentWiredType } from '../factory/factory.component';\nimport { isFunction } from 'lodash';\nimport { PYICore, PYICoreClass } from '../core';\nimport { PYIConfiguration, PYIAppConfiguration } from './configuration';\n\nexport class PYIComponent<Props = any> extends PYICore {\n\n    public static _base() {\n        return PYIComponent;\n    }\n\n    public props!: Props;\n\n    constructor(props?: Props) {\n        super();\n    }\n\n    public input() {\n        return this;\n    }\n\n    public output() {\n        return this;\n    }\n}\n\nexport function Component<V extends PYICoreClass<PYIComponent<any>>>(target: V): V;\nexport function Component<Props = any>(\n    config: Props\n): <V extends PYICoreClass<PYIComponent<Props>>>(target: V) => V;\nexport function Component(props: any) {\n    const base = props && props._base && isFunction(props._base) && props._base();\n    if (base === PYIComponent) {\n        return props;\n    }\n\n    return (target: PYICoreClass<PYIComponent>) => {\n        return target;\n    };\n}\n\nexport interface AutowiredConfiguration {\n    [x: string]: any;\n    singleton?: boolean;\n}\n\n/**\n * 自动注入新类\n * @param target classes(主类)\n * @param key prototype(键)\n */\n// tslint:disable-next-line: adjacent-overload-signatures\nexport function autowired(target: any, method: string): any;\nexport function autowired(\n    config: AutowiredConfiguration\n): (target: any, metod: string) => any;\nexport function autowired(props: any, method?: string) {\n    if (method) {\n        const C = Reflect.getMetadata('design:type', props, method);\n        props[method] = wired(method, C);\n        return props[method];\n    }\n    return (target: any, kmethod: string) => {\n        const C = Reflect.getMetadata('design:type', target, kmethod);\n        target[kmethod] = wired(kmethod, C, props.singleton, props);\n        return target[kmethod];\n    };\n}\n\nexport function wired(\n    method: string,\n    injeactor: PYICore,\n    type?: ComponentWiredType,\n    props?: AutowiredConfiguration,\n) {\n    if (\n        injeactor._base() === PYIConfiguration ||\n        injeactor._base() === PYIAppConfiguration\n    ) {\n        return new FactoryComponent(method, injeactor, type ? type : ComponentWiredType.AUTOCONNECT, props);\n    }\n    return new FactoryComponent(method, injeactor, type ? type : ComponentWiredType.AUTOWIRED, props);\n}\n"]}